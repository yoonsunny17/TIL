# 05 네트워크 계층 : 목적지에 데이터 전달하기

> 네트워크 계층

* 서로 다른 네트워크에 있는 목적지로 데이터를 전송하기 위해 필요
* **네트워크 간의 통신**을 가능하게 하는 것이 역할 (데이터 링크 계층만으로는 같은 네트워크 안에서만 통신 가능)
* 다른 네트워크로 데이터를 전송하기 위해 **라우터**라는 장비가 필요
  * 가정이나 소규모 기업 용도로 만든 라우터 = 인터네 공유기
  * 목적지가 정해지지 않으면 경로 설정 불가
  * 데이터의 목적지가 정해지면 어떤 **경로로 가는 것이 좋은지를 알려주는 기능**을 함
* 데이터 목적지, 네트워크 식별 주소를 **IP 주소**라고 함
  * IP로 어떤 네트워크의 어떤 컴퓨터인지 구분 가능
  * 이것이 있어야 목적지 지정 가능
* 목적지까지 가는 경로를 결정하는 것을 **라우팅**이라고 함
  * 라우팅은 라우터가 하는데 레이어 3 스위치라는 장비도 라우팅을 할 수 있음
* 라우터는 거리 상관 없음



> IP

* 네트워크 계층의 대표적인 프로토콜
  * 출발지 IP 주소	
  * 목적지 IP 주소

> IP 주소의 구조

* ISP에게 받을 수 있음 (ISP의 대표적인 예시: KT, SK브로드밴드, LG유플러스)
* IPv4
  * 32비트로 약 43억개의 IP주소를 만들 수 있음. 하지만 이것만으로는 충분하지 않아서 IPv6를 사용하게 됨

* IPv6
  * 128비트로 되어 있음
  * IP주소 부족 문제를 해결
* 공인 IP 주소
  * ISP가 제공
* IP주소가 제한적이므로(IPv4인 경우) 같은 랜 안에 여러 컴퓨터가 있다면 공인 IP주소는 라우터에만 할당하고, 컴퓨터들 (나머지 장치)에는 랜의 네트워크 관리자가 사설 IP 주소를 할당하거나, 라우터의 DHCP 기능을 사용해 자동으로 주소 할당
  * DHCP: 동적 호스트 설정 통신 규약
* IP 주소는 두 가지로 나뉨
  * 네트워크 ID: 어떤 네트워크인지를 나타냄
  * 호스트 ID: 해당 네트워크의 어느 컴퓨터인지를 나타냄

> IP 주소의 클래스 구조

* 일반 네트워크는 A ~ C 클래스까지 사용 가능
* 각 클래스 내부에서 공인 IP 주소와 사설 IP 주소 범위가 나뉘어짐

> 네트워크 주소/브로드캐스트 주소

* 네트워크 주소
  * 호스트 ID가 10진수로 0인 주소
  * 전체 네트워크에서 작은 네트워크를 식별하는 데 사용되는 주소
  * 호스트 ID가 0이면 해당 네트워크를 대표하는 주소
* 브로드캐스트 주소
  * 호스트 ID가 10진수로 255인 주소
  * 네트워크에 있는 컴퓨터나 장비 모두에 한번에 데이터를 전송하는 데 사용되는 주소
* 위의 두 주소는 개별적인 IP주소로 설정할 수 없음(설정하면 안됨)

> 서브넷

* 네트워크의 분할을 서브넷팅(subneting), 분할된 네트워크를 서브넷이라고 함.
* 서브넷 마스크
  * 서브넷팅하면 네트워크 ID와 호스트 ID의 경계가 불분명해질 수 있음. 이때 사용하는 것이 서브넷 마스크
  * 네트워크 ID와 호스트 ID를 식별하기 위한 값
  * 프리픽스(prefix) 표기법 : 슬래시/비트수로 나타낸 것. 예를 들어 A클래스는 /8로 표시

> 라우터

* 다른 네트워크로 패킷을 전송할 수 있게 해줌 (서로 다른 네트워크를 연결)
* 라우터를 이용해 네트워크 분리 가능
* 스위치만 있는 네트워크에서는 모든 컴퓨터와 스위치가 동일한 네트워크에 속함 (네트워크 분리 불가능)
* 네트워크 분리 후 다른 네트워크 접속하는 방법
  * 컴퓨터가 분리된 다른 네트워크로 데이터를 전송하려면 라우터의 IP 주소를 설정해야 함(네트워크 출입구 설정, **기본 게이트웨이**(default gateway, 네트워크 외부에 접속할 때 사용))
    * 주소를 설정하는 이유는 네트워크가 나뉘어서 데이터 전송 목적지를 알지 못하기 때문. 따라서 네트워크 출입구를 지정하고 라우터에 데이터를 전송
    * 인터넷 프로토콜 속성에 '자동으로 IP 주소 받기'가 체크되어 있으면 기본 게이트웨이가 자동으로 설정됨
  * 주소 설정 후 라우팅을 통해 데이터 전송
  * 경로 정보가 저장되어 있는 곳이 **라우팅 테이블**
    * 라우팅 테이블은 다른 네트워크로 가기 위한 가장 좋은 라우터의 정보를 가짐